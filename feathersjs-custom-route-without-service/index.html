<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Create a custom route in FeathersJS without creating new service - Yet another software engineer</title><link rel=icon type=image/png href=icons/myicon.png><meta name=viewport content="width=device-width,initial-scale=1">
<meta property="og:title" content="Create a custom route in FeathersJS without creating new service"><meta property="og:description" content="Create a custom route in FeathersJS without creating a new service. A short video of the whole process is given as well."><meta property="og:type" content="article"><meta property="og:url" content="http://anotherdev.xyz/feathersjs-custom-route-without-service/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-11-19T19:59:24+00:00"><meta property="article:modified_time" content="2019-11-19T19:59:24+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Create a custom route in FeathersJS without creating new service"><meta name=twitter:description content="Create a custom route in FeathersJS without creating a new service. A short video of the whole process is given as well."><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=http://anotherdev.xyz/css/normalize.css><link rel=stylesheet type=text/css media=screen href=http://anotherdev.xyz/css/main.css><link rel=stylesheet type=text/css href=http://anotherdev.xyz/css/custom.css><link rel=stylesheet type=text/css href=http://anotherdev.xyz/css/dark.css media="(prefers-color-scheme: dark)"><script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script><script src=http://anotherdev.xyz/js/main.js></script><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-KX5L8P2")</script></head><body><div class="container wrapper post"><div class=header><base href=http://anotherdev.xyz/><h1 class=site-title><a href=http://anotherdev.xyz/>Yet another software engineer</a></h1><div class=site-description><h2>My thoughts are my own</h2><nav class="nav social"><ul class=flat><a href=https://github.com/shihabmridha title=Github><i data-feather=github></i></a><a href=https://twitter.com/shihabmridha title=Twitter><i data-feather=twitter></i></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=http://anotherdev.xyz/>Home</a></li><li><a href=http://anotherdev.xyz/posts>All notes</a></li><li><a href=http://anotherdev.xyz/about>About</a></li><li><a href=http://anotherdev.xyz/tags>Tags</a></li></ul></nav></div><div class=post-header><h1 class=title>Create a custom route in FeathersJS without creating new service</h1><div class=meta>Posted at &mdash; Nov 19, 2019</div></div><div class=markdown><p>If you do not know what <a href=https://feathersjs.com/>FeathersJS</a> is then this line is for you. It is taken from FeathersJS&rsquo;s official website.</p><blockquote><p>A framework for real-time applications and REST APIs</p></blockquote><h3 id=index>Index</h3><ul><li><a href=#why-feathers>Why use FeathersJS?</a></li><li><a href=#install-feathers>Install FeathersJS</a></li><li><a href=#create-app>Create new app</a></li><li><a href=#new-service>Create new service</a></li><li><a href=#custom-route>Create custom route</a></li></ul><ul><li>Create an app from scratch within a minute.</li><li>Create REST API with zero configuration.</li><li>Create Real-Time API with zero configuration.</li><li>Service oriented application.</li><li>Database agnostic.</li><li>Supports TypeScript. <a href=__GHOST_URL__/typescript-nodejs-get-start/>Why is this important</a>?</li><li>CLI to create CRUD using single command.</li></ul><p>There are more features that I about Feathers for example: hooks, auto configured authentication, auto configured test using mocha and more.</p><p>I am assuming you already know how to install, create app and create service using feathers. I am writing an small instruction for those who does not know yet. I will use the latest version of Feathers which is <strong>4.2.3</strong>.</p><p>Run the following command to install feathers CLI <code>npm install -g @feathersjs/cli</code> .</p><p>First of all create a folder then navigate to it and run the following command <code>feathers generate app</code>. You will be asked a few questions like app name, source folder name, which package manager would the CLI use, is it typescript app or javascript, type of API (REST/Real-time/Both) etc.</p><p>For this topic I am going to create a service named <strong>organizations</strong>. **** To do that run the following command <code>feathers generate service</code>. You will be asked a few queries related to your service. CLI will perform a few actions to create a new service. One of the action is create a new folder inside <strong><em>[source_directory] > services</em></strong>. For my case it looks like this: <strong><em>src > services > organizations</em></strong><em>.</em> Our organizations service is ready to CRUD.</p><p>Organizations directory has three files in it. They are <strong>organizations.class.js, organizations.hooks.js, organizations.service.js</strong>. We will be focusing on <strong>.class</strong> and <strong>.service</strong> file in this article.</p><p>Initially the <strong>organizations.class.js</strong> and <strong>organizations.service.js</strong> file would look like this.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#268bd2>const</span> { Service } <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;feathers-mongoose&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exports.Organizations <span style=color:#719e07>=</span> <span style=color:#268bd2>class</span> Organizations <span style=color:#268bd2>extends</span> Service {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#586e75>// Initializes the `organizations` service on path `/organizations`
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>const</span> { Organizations } <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;./organizations.class&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#268bd2>const</span> createModel <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;../../models/organizations.model&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#268bd2>const</span> hooks <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;./organizations.hooks&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>module.exports <span style=color:#719e07>=</span> <span style=color:#268bd2>function</span> (app) {
</span></span><span style=display:flex><span>  <span style=color:#268bd2>const</span> options <span style=color:#719e07>=</span> {
</span></span><span style=display:flex><span>    Model<span style=color:#719e07>:</span> createModel(app),
</span></span><span style=display:flex><span>    paginate<span style=color:#719e07>:</span> app.get(<span style=color:#2aa198>&#39;paginate&#39;</span>)
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#586e75>// Initialize our service with any options it requires
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>  app.use(<span style=color:#2aa198>&#39;/organizations&#39;</span>, <span style=color:#719e07>new</span> Organizations(options, app));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#586e75>// Get our initialized service so that we can register hooks
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>  <span style=color:#268bd2>const</span> service <span style=color:#719e07>=</span> app.service(<span style=color:#2aa198>&#39;organizations&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  service.hooks(hooks);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=the-easy-way>The easy way</h2><p>FeathersJS uses ExpressJS under the hood. So, we will be able to take advantage of it. To make a custom route the easy way follow the code block below and notice from line 15 to 18.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#719e07>//</span> Initializes the <span style=color:#719e07>`</span>organizations<span style=color:#719e07>`</span> service <span style=color:#719e07>on</span> path <span style=color:#719e07>`/</span>organizations<span style=color:#719e07>`</span>
</span></span><span style=display:flex><span>const { Organizations } <span style=color:#719e07>=</span> <span style=color:#719e07>require</span>(<span style=color:#2aa198>&#39;./organizations.class&#39;</span>);
</span></span><span style=display:flex><span>const createModel <span style=color:#719e07>=</span> <span style=color:#719e07>require</span>(<span style=color:#2aa198>&#39;../../models/organizations.model&#39;</span>);
</span></span><span style=display:flex><span>const hooks <span style=color:#719e07>=</span> <span style=color:#719e07>require</span>(<span style=color:#2aa198>&#39;./organizations.hooks&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>module.exports <span style=color:#719e07>=</span> <span style=color:#268bd2>function</span> (app) {
</span></span><span style=display:flex><span>  const options <span style=color:#719e07>=</span> {
</span></span><span style=display:flex><span>    Model: <span style=color:#268bd2>createModel</span>(app),
</span></span><span style=display:flex><span>    paginate: app.<span style=color:#268bd2>get</span>(<span style=color:#2aa198>&#39;paginate&#39;</span>)
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#719e07>//</span> Initialize our service <span style=color:#719e07>with</span> any options it requires
</span></span><span style=display:flex><span>  app.<span style=color:#719e07>use</span>(<span style=color:#2aa198>&#39;/organizations&#39;</span>, new <span style=color:#268bd2>Organizations</span>(options, app));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#719e07>//</span> Initialize our custom route
</span></span><span style=display:flex><span>  app.<span style=color:#268bd2>get</span>(<span style=color:#2aa198>&#39;/custom-organizations&#39;</span>, (req, res) <span style=color:#719e07>=&gt;</span> {
</span></span><span style=display:flex><span>  	res.<span style=color:#268bd2>send</span>(<span style=color:#2aa198>&#39;Hello from custom route&#39;</span>);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#719e07>//</span> Get our initialized service so that we can register hooks
</span></span><span style=display:flex><span>  const service <span style=color:#719e07>=</span> app.<span style=color:#268bd2>service</span>(<span style=color:#2aa198>&#39;organizations&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  service.<span style=color:#268bd2>hooks</span>(hooks);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=the-feathers-way>The feathers way</h2><p>In the <strong>service > organizations</strong> directory create a new file named <strong>custom-organizations.class.js</strong>. Copy everything from <strong>organizations.class.js</strong> and rename Organizations to CustomOrganizations. Now the file should look like this.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#268bd2>const</span> { Service } <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;feathers-mongoose&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exports.CustomOrganizations <span style=color:#719e07>=</span> <span style=color:#268bd2>class</span> CustomOrganizations <span style=color:#268bd2>extends</span> Service {
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>Now we have to connect this custom class with our service somehow. Here is how you can achieve it. This is update version of <strong>organizations.service.js</strong>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#586e75>// Initializes the `organizations` service on path `/organizations`
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>const</span> { Organizations } <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;./organizations.class&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#268bd2>const</span> { CustomOrganizations } <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;./custom-organizations.class&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#268bd2>const</span> createModel <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;../../models/organizations.model&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#268bd2>const</span> hooks <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;./organizations.hooks&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>module.exports <span style=color:#719e07>=</span> <span style=color:#268bd2>function</span> (app) {
</span></span><span style=display:flex><span>  <span style=color:#268bd2>const</span> options <span style=color:#719e07>=</span> {
</span></span><span style=display:flex><span>    Model<span style=color:#719e07>:</span> createModel(app),
</span></span><span style=display:flex><span>    paginate<span style=color:#719e07>:</span> app.get(<span style=color:#2aa198>&#39;paginate&#39;</span>)
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#586e75>// Initialize our service with any options it requires
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>  app.use(<span style=color:#2aa198>&#39;/organizations&#39;</span>, <span style=color:#719e07>new</span> Organizations(options, app));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#586e75>// Initialize our custom route
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>  app.use(<span style=color:#2aa198>&#39;/custom-organizations&#39;</span>, <span style=color:#719e07>new</span> CustomOrganizations(options, app));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#586e75>// Get our initialized service so that we can register hooks
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>  <span style=color:#268bd2>const</span> service <span style=color:#719e07>=</span> app.service(<span style=color:#2aa198>&#39;organizations&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  service.hooks(hooks);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>Notice line number 3 and 17. First imported the class in service, then register the class on the applicaton.</p><blockquote><p><em><strong>Technically, we are creating a new feathers service.</strong></em></p></blockquote><p>Now run the app and hit <code>/custom-organizations</code>. You should get expected response.</p><h2 id=conclusion>Conclusion</h2><p>Technically speaking we had to create a new service but, also for simple task this way of creating a custom endpoint is convenient in my opinion.</p><h2 id=video>Video</h2><h3 id=reference>Reference:</h3><ul><li>The image is from feathers&rsquo;s official website.</li></ul></div><div class=post-tags><nav class="nav tags"><ul class=flat><li><a href=http://anotherdev.xyz/tags/feathersjs>feathersjs</a></li><li><a href=http://anotherdev.xyz/tags/nodejs>nodejs</a></li></ul></nav></div></div><div class="footer wrapper"><nav class=nav><div>© Another Dev | <a href=https://github.com/vividvilla/ezhil>Ezhil theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></nav></div><script>feather.replace()</script></body></html>